<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Level 1 - Fallback | Ardias</title>
<meta name="keywords" content="Ethernaut">
<meta name="description" content="Hello Readers!
Kita akan melanjutkan series Ethernaut ini dan kita akan bermain di level 1 yaitu Fallback
Pada level kali ini tidak seperti sebelumnya kita langsung diberikan sebuah source code smart contract nya untuk menyelesaikan level ini, berikut adalah source codenya
// SPDX-License-Identifier: MIT pragma solidity ^0.8.0; contract Fallback { mapping(address =&gt; uint) public contributions; address public owner; constructor() { owner = msg.sender; contributions[msg.sender] = 1000 * (1 ether); } modifier onlyOwner { require( msg.">
<meta name="author" content="Ardias">
<link rel="canonical" href="https://agilfchx.github.io/posts/level1-fallback/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css" integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U&#43;6hYRq/Ez/nm5vg=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://agilfchx.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://agilfchx.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://agilfchx.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://agilfchx.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://agilfchx.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Level 1 - Fallback" />
<meta property="og:description" content="Hello Readers!
Kita akan melanjutkan series Ethernaut ini dan kita akan bermain di level 1 yaitu Fallback
Pada level kali ini tidak seperti sebelumnya kita langsung diberikan sebuah source code smart contract nya untuk menyelesaikan level ini, berikut adalah source codenya
// SPDX-License-Identifier: MIT pragma solidity ^0.8.0; contract Fallback { mapping(address =&gt; uint) public contributions; address public owner; constructor() { owner = msg.sender; contributions[msg.sender] = 1000 * (1 ether); } modifier onlyOwner { require( msg." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://agilfchx.github.io/posts/level1-fallback/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-18T23:14:53+07:00" />
<meta property="article:modified_time" content="2023-08-18T23:14:53+07:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Level 1 - Fallback"/>
<meta name="twitter:description" content="Hello Readers!
Kita akan melanjutkan series Ethernaut ini dan kita akan bermain di level 1 yaitu Fallback
Pada level kali ini tidak seperti sebelumnya kita langsung diberikan sebuah source code smart contract nya untuk menyelesaikan level ini, berikut adalah source codenya
// SPDX-License-Identifier: MIT pragma solidity ^0.8.0; contract Fallback { mapping(address =&gt; uint) public contributions; address public owner; constructor() { owner = msg.sender; contributions[msg.sender] = 1000 * (1 ether); } modifier onlyOwner { require( msg."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://agilfchx.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Level 1 - Fallback",
      "item": "https://agilfchx.github.io/posts/level1-fallback/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Level 1 - Fallback",
  "name": "Level 1 - Fallback",
  "description": "Hello Readers!\nKita akan melanjutkan series Ethernaut ini dan kita akan bermain di level 1 yaitu Fallback\nPada level kali ini tidak seperti sebelumnya kita langsung diberikan sebuah source code smart contract nya untuk menyelesaikan level ini, berikut adalah source codenya\n// SPDX-License-Identifier: MIT pragma solidity ^0.8.0; contract Fallback { mapping(address =\u0026gt; uint) public contributions; address public owner; constructor() { owner = msg.sender; contributions[msg.sender] = 1000 * (1 ether); } modifier onlyOwner { require( msg.",
  "keywords": [
    "Ethernaut"
  ],
  "articleBody": "Hello Readers!\nKita akan melanjutkan series Ethernaut ini dan kita akan bermain di level 1 yaitu Fallback\nPada level kali ini tidak seperti sebelumnya kita langsung diberikan sebuah source code smart contract nya untuk menyelesaikan level ini, berikut adalah source codenya\n// SPDX-License-Identifier: MIT pragma solidity ^0.8.0; contract Fallback { mapping(address =\u003e uint) public contributions; address public owner; constructor() { owner = msg.sender; contributions[msg.sender] = 1000 * (1 ether); } modifier onlyOwner { require( msg.sender == owner, \"caller is not the owner\" ); _; } function contribute() public payable { require(msg.value \u003c 0.001 ether); contributions[msg.sender] += msg.value; if(contributions[msg.sender] \u003e contributions[owner]) { owner = msg.sender; } } function getContribution() public view returns (uint) { return contributions[msg.sender]; } function withdraw() public onlyOwner { payable(owner).transfer(address(this).balance); } receive() external payable { require(msg.value \u003e 0 \u0026\u0026 contributions[msg.sender] \u003e 0); owner = msg.sender; } } Goals untuk menyelesaikan level ini adalah :\nKita sebagai player harus claim ownership contract tersebut Mengurangi balancenya ke 0/withdraw semua amount yang ada di contract tersebut Breakdown the code Oke mari kita breakdown setiap code yang ada pada source code tersebut satu persatu\nmapping(address =\u003e uint) public contributions; \u003c= 1 address public owner; \u003c= 2 Pada contract Fallback ini terdapat 2 variable yaitu:\ncontributions yang bertipe data mapping , yang dimana mapping ini akan menyimpan tipe data ke tipe data lainnya. Disini dia akan memetakan/mapping address ke tipe data uint atau simple nya data bertipe uint akan disimpan pada address owner merupakan pemilik dari contract ini constructor() { owner = msg.sender; \u003c= 1 contributions[msg.sender] = 1000 * (1 ether); \u003c= 2 } Pada constructor kita breakdown seperti berikut\nVariable owner akan di set oleh msg.sender pertama atau orang yang melakukan deploy contract tersebut. contributions[msg.sender] ini menetapkan nilai kontribusi msg.sender sebesar 1000 Ether (1000 * 1 ether) dalam satuan wei modifier onlyOwner { require( msg.sender == owner, \"caller is not the owner\" ); _; } Modifer onlyOwner ini untuk memastikan bahwa function tersebut hanya bisa dijalankan oleh owner itu sendiri (msg_sender == owner) dan jika bukan owner akan muncul output caller is not the owner. Dan terakhir _; merupakan tanda untuk melanjutkan jika modifier ini sudah diperiksa dan sesuai.\nfunction contribute() public payable { require(msg.value \u003c 0.001 ether); \u003c= 1 contributions[msg.sender] += msg.value; \u003c= 2 if(contributions[msg.sender] \u003e contributions[owner]) { \u003c= 3 owner = msg.sender; \u003c= 4 } } Selanjutnya terdapat function contribute yang dimana dapat menerima Ether (payable), berikut nya pada body functionnya ini terdapat:\nrequire disini bertujuan untuk memeriksa apakah nilai Ether yang diberikan dalam transaksi kurang dari 0.001 Ether, jika tidak memenuhi maka perintah dibawahnya tidak akan dijalankan/transaksi gagal. contributions[msg.sender] akan menambahkan nilai Ether yang diterima dari transaksi ke address pengirim Kondisi ini mengecek apakah kontribusi msg.sender lebih besar dibanding milik owner Jika kondisi tersebut true maka ownership contract akan dignati menjadi pengirim atau msg.sender yang melakukan kontribusi function getContribution() public view returns (uint) { return contributions[msg.sender]; } Pada function getContribution ini cukup simple, dia akan melakukan return address dari msg.sender berupa uint atau data berapa besar dia kontribusi.\nfunction withdraw() public onlyOwner { payable(owner).transfer(address(this).balance); } Pada function withdraw ini akan melakukan withdraw tetapi dengan syarat dia adalah onlyOwner atau owner dari contract tersebut.\nreceive() external payable { require(msg.value \u003e 0 \u0026\u0026 contributions[msg.sender] \u003e 0); owner = msg.sender; } receive() merupakan function yang mirip dengan fallback function tetapi receive ini bertujuan untuk menangani ether yang masuk tanpa perlu panggilan data. Disini dia melakukan pemeriksaan atau require seperti apakah msg.value nya lebih dari 0 DAN contributions[msg.sender] memiliki kontribusi lebih dari 0 dan jika kondisi tersebut terpenuhi maka msg.sender atau caller ini akan menjadi owner dari contract ini.\nExplainoit (Explain \u0026 Exploit) Oke dari source code yang didapatkan kita mendapatkan beberapa informasi yang bisa membantu kita menyelesaikan level ini, yaitu:\nPada function contribute kita bisa mengubah ownership contract dengan cara value kontribusi kita harus lebih besar dari owner yaitu 1000 Ether üòÆ Kita juga bisa menjadi ownership contract di receive function yang dimana terdapat sebuah require seperti value yang dikirimkan lebih dari 0 dan kontribusi lebih dari 0 juga Dari informasi ke 2 ini kita dapat melakukan merubah ownership contract tanpa perlu mengeluarkan ether yang banyak. Intinya adalah kita akan melakukan hit/interaksi ke receive function langsung karena kita bisa menjadi ownership contract juga dari function fallback tersebut.\nSebelum melakukan exploit mari kita cari tahu dahulu address owner contract ini. Untuk melihat siapa owner contract ini bisa menjalankan perintah berikut ini di console\nawait contract.owner() Dan kita lihat bahwa address owner contract sekarang adalah 0x2279B7A0a67DB372996a5FaB50D91eAA73d2eBe6\nInitial Owner Address Selanjutnya, karena receive() memerlukan require salah satunya contributions[msg.sender] \u003e 0\nkita perlu menjalankan contribute() terlebih dahulu untuk membuat kontribusi, berikut perintah untuk melakukan kontribusi dan nanti akan muncul popup metamask untuk konfirmasi transaksi\nawait contract.contribute({ value: 1 }) // untuk value gunakan saja yang terendah, seperti diatas yaitu hanya 1 wei Running await contract.contribute() in console Lalu kita cek dahulu apakah contribution kita sudah masuk atau belum dengan menjalankan perintah berikut\nawait contract.getContribution().then(v =\u003e v.toString()) Running await contract.getContribution() in console Selanjutnya, untuk melakukan interaksi langsung ke fallback atau receive kita bisa menjalankan perintah berikut ini dan akan muncul popup metamask seperti biasa untuk konfirmasi\nawait contract.sendTransaction({ from: player, value: 1 }) Running await contract.sendTransaction() in console Sekarang jika kita lihat owner contractnya sudah berubah sesuai dengan address yang kita miliiki\nOwner contract address changed to our address Langkah terakhir adalah melakukan withdraw dengan menjalankan perintah berikut ini dan kalian bisa lihat balance kalian bertambah\nawait contract.withdraw() Running await contract.withdraw() in console Setelah selesai lakukan Submit Instance dann level 1 pun selesai\nOke level 1 sudah mulai menantang karena kita mencari code yang memungkinkan bisa kita exploit untuk mendapatkan owner dari contract itu sendiri. Baiklah kalau begitu mungkin segitu saja untuk level 1 ini, kita akan lanjutkan kembali level 2 dan seterusnya üî•\nSeeya üëãüê¢\n",
  "wordCount" : "959",
  "inLanguage": "en",
  "datePublished": "2023-08-18T23:14:53+07:00",
  "dateModified": "2023-08-18T23:14:53+07:00",
  "author":{
    "@type": "Person",
    "name": "Ardias"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://agilfchx.github.io/posts/level1-fallback/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Ardias",
    "logo": {
      "@type": "ImageObject",
      "url": "https://agilfchx.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://agilfchx.github.io/" accesskey="h" title="Ardias (Alt + H)">
                <img src="https://agilfchx.github.io/logo.png" alt="" aria-label="logo"
                    height="35">Ardias</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://agilfchx.github.io/posts" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://agilfchx.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://agilfchx.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://agilfchx.github.io/">Home</a>&nbsp;¬ª&nbsp;<a href="https://agilfchx.github.io/posts/">Posts</a></div>
    <h1 class="post-title">
      Level 1 - Fallback
    </h1>
    <div class="post-meta"><span title='2023-08-18 23:14:53 +0700 +0700'>August 18, 2023</span>&nbsp;¬∑&nbsp;5 min&nbsp;¬∑&nbsp;Ardias

</div>
  </header> 
  <div class="post-content"><p>Hello Readers!</p>
<p>Kita akan melanjutkan series Ethernaut ini dan kita akan bermain di level 1 yaitu <code>Fallback</code></p>
<p>Pada level kali ini tidak seperti sebelumnya kita langsung diberikan sebuah source code smart contract nya untuk menyelesaikan level ini, berikut adalah source codenya</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span><span style="color:#75715e">// SPDX-License-Identifier: MIT
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">pragma solidity</span> <span style="color:#f92672">^</span><span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">8</span>.<span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">Fallback</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">mapping</span>(<span style="color:#66d9ef">address</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">uint</span>) <span style="color:#66d9ef">public</span> contributions;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">address</span> <span style="color:#66d9ef">public</span> owner;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">constructor</span>() {
</span></span><span style="display:flex;"><span>    owner <span style="color:#f92672">=</span> msg.sender;
</span></span><span style="display:flex;"><span>    contributions[msg.sender] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000</span> <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span> <span style="color:#66d9ef">ether</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">modifier</span> <span style="color:#a6e22e">onlyOwner</span> {
</span></span><span style="display:flex;"><span>        require(
</span></span><span style="display:flex;"><span>            msg.sender <span style="color:#f92672">==</span> owner,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;caller is not the owner&#34;</span>
</span></span><span style="display:flex;"><span>        );
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">_</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">contribute</span>() <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">payable</span> {
</span></span><span style="display:flex;"><span>    require(msg.value <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">001</span> <span style="color:#66d9ef">ether</span>);
</span></span><span style="display:flex;"><span>    contributions[msg.sender] <span style="color:#f92672">+=</span> msg.value;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(contributions[msg.sender] <span style="color:#f92672">&gt;</span> contributions[owner]) {
</span></span><span style="display:flex;"><span>      owner <span style="color:#f92672">=</span> msg.sender;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getContribution</span>() <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">view</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> contributions[msg.sender];
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">withdraw</span>() <span style="color:#66d9ef">public</span> onlyOwner {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">payable</span>(owner).transfer(<span style="color:#66d9ef">address</span>(this).balance);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  receive() <span style="color:#66d9ef">external</span> <span style="color:#66d9ef">payable</span> {
</span></span><span style="display:flex;"><span>    require(msg.value <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> contributions[msg.sender] <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>    owner <span style="color:#f92672">=</span> msg.sender;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><blockquote>
<p>Goals untuk menyelesaikan level ini adalah :</p>
</blockquote>
<ol>
<li>Kita sebagai <code>player</code> harus claim <code>ownership</code> contract tersebut</li>
<li>Mengurangi balancenya ke 0/withdraw semua amount yang ada di contract tersebut
<blockquote>
</blockquote>
</li>
</ol>
<h3 id="breakdown-the-code">Breakdown the code<a hidden class="anchor" aria-hidden="true" href="#breakdown-the-code">#</a></h3>
<p>Oke mari kita breakdown setiap code yang ada pada source code tersebut satu persatu</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span><span style="color:#66d9ef">mapping</span>(<span style="color:#66d9ef">address</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">uint</span>) <span style="color:#66d9ef">public</span> contributions;        <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">address</span> <span style="color:#66d9ef">public</span> owner;                                 <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">2</span>
</span></span></code></pre></div><p>Pada contract <code>Fallback</code> ini terdapat 2 variable yaitu:</p>
<ol>
<li><code>contributions</code> yang bertipe data <code>mapping</code> , yang dimana mapping ini akan menyimpan tipe data ke tipe data lainnya. Disini dia akan memetakan/mapping <code>address</code> ke tipe data <code>uint</code> atau simple nya data bertipe <code>uint</code> akan disimpan pada <code>address</code></li>
<li><code>owner</code> merupakan pemilik dari contract ini</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span>  <span style="color:#66d9ef">constructor</span>() {
</span></span><span style="display:flex;"><span>    owner <span style="color:#f92672">=</span> msg.sender;                                <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    contributions[msg.sender] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000</span> <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span> <span style="color:#66d9ef">ether</span>);      <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>Pada <code>constructor</code> kita breakdown seperti berikut</p>
<ol>
<li>Variable <code>owner</code> akan di set oleh <code>msg.sender</code> pertama atau orang yang melakukan deploy contract tersebut.</li>
<li><code>contributions[msg.sender]</code> ini menetapkan nilai kontribusi <code>msg.sender</code> sebesar 1000 Ether (1000 * 1 ether) dalam satuan wei</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span>  <span style="color:#66d9ef">modifier</span> <span style="color:#a6e22e">onlyOwner</span> {
</span></span><span style="display:flex;"><span>        require(
</span></span><span style="display:flex;"><span>            msg.sender <span style="color:#f92672">==</span> owner,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;caller is not the owner&#34;</span>
</span></span><span style="display:flex;"><span>        );
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">_</span>;
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>Modifer <code>onlyOwner</code> ini untuk memastikan bahwa function tersebut hanya bisa dijalankan oleh <code>owner</code> itu sendiri (<code>msg_sender == owner</code>) dan jika bukan owner akan muncul output <code>caller is not the owner</code>. Dan terakhir <code>_;</code> merupakan tanda untuk melanjutkan jika modifier ini sudah diperiksa dan sesuai.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span>  <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">contribute</span>() <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">payable</span> {
</span></span><span style="display:flex;"><span>    require(msg.value <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">001</span> <span style="color:#66d9ef">ether</span>);                           <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    contributions[msg.sender] <span style="color:#f92672">+=</span> msg.value;                     <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(contributions[msg.sender] <span style="color:#f92672">&gt;</span> contributions[owner]) {      <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>      owner <span style="color:#f92672">=</span> msg.sender;                                       <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>Selanjutnya terdapat function <code>contribute</code> yang dimana dapat menerima Ether (payable), berikut nya pada body functionnya ini terdapat:</p>
<ol>
<li><code>require</code> disini bertujuan untuk memeriksa apakah nilai Ether yang diberikan dalam transaksi kurang dari 0.001 Ether, jika tidak memenuhi maka perintah dibawahnya tidak akan dijalankan/transaksi gagal.</li>
<li><code>contributions[msg.sender]</code> akan menambahkan nilai Ether yang diterima dari transaksi ke address pengirim</li>
<li>Kondisi ini mengecek apakah kontribusi <code>msg.sender</code> lebih besar dibanding milik <code>owner</code></li>
<li>Jika kondisi tersebut <code>true</code> maka ownership contract akan dignati menjadi pengirim atau <code>msg.sender</code> yang melakukan kontribusi</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getContribution</span>() <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">view</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>) {
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">return</span> contributions[msg.sender];
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Pada function <code>getContribution</code> ini cukup simple, dia akan melakukan return address dari <code>msg.sender</code> berupa <code>uint</code> atau data berapa besar dia kontribusi.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">withdraw</span>() <span style="color:#66d9ef">public</span> onlyOwner {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">payable</span>(owner).transfer(<span style="color:#66d9ef">address</span>(this).balance);
</span></span><span style="display:flex;"><span> }
</span></span></code></pre></div><p>Pada function <code>withdraw</code> ini akan melakukan withdraw tetapi dengan syarat dia adalah <code>onlyOwner</code> atau <code>owner</code> dari contract tersebut.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span>  receive() <span style="color:#66d9ef">external</span> <span style="color:#66d9ef">payable</span> {
</span></span><span style="display:flex;"><span>    require(msg.value <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> contributions[msg.sender] <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>    owner <span style="color:#f92672">=</span> msg.sender;
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p><code>receive()</code> merupakan function yang mirip dengan fallback function tetapi receive ini bertujuan untuk menangani ether yang masuk tanpa perlu panggilan data. Disini dia melakukan pemeriksaan atau <code>require</code> seperti apakah <code>msg.value</code> nya lebih dari 0 DAN <code>contributions[msg.sender]</code> memiliki kontribusi lebih dari 0 dan jika kondisi tersebut terpenuhi maka <code>msg.sender</code> atau caller ini akan menjadi <code>owner</code> dari contract ini.</p>
<h3 id="explainoit-explain--exploit">Explainoit (Explain &amp; Exploit)<a hidden class="anchor" aria-hidden="true" href="#explainoit-explain--exploit">#</a></h3>
<p>Oke dari source code yang didapatkan kita mendapatkan beberapa informasi yang bisa membantu kita menyelesaikan level ini, yaitu:</p>
<ol>
<li>Pada function <code>contribute</code> kita bisa mengubah ownership contract dengan cara <code>value</code> kontribusi kita harus lebih besar dari owner yaitu 1000 Ether üòÆ</li>
<li>Kita juga bisa menjadi ownership contract di <code>receive</code> function yang dimana terdapat sebuah require seperti <strong><em>value yang dikirimkan lebih dari 0</em></strong> dan <strong><em>kontribusi lebih dari 0</em></strong> juga</li>
</ol>
<p>Dari informasi ke 2 ini kita dapat melakukan merubah ownership contract tanpa perlu mengeluarkan ether yang banyak. Intinya adalah kita akan melakukan hit/interaksi ke <code>receive</code> function langsung karena kita bisa menjadi ownership contract juga dari function fallback tersebut.</p>
<p>Sebelum melakukan exploit mari kita cari tahu dahulu address owner contract ini. Untuk melihat siapa owner contract ini bisa menjalankan perintah berikut ini di console</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span>await <span style="color:#66d9ef">contract</span>.owner()
</span></span></code></pre></div><p>Dan kita lihat bahwa address owner contract sekarang adalah <code>0x2279B7A0a67DB372996a5FaB50D91eAA73d2eBe6</code></p>
<figure class="align-center ">
    <img loading="lazy" src="/images/20230818/owner.png#center"/> <figcaption>
            Initial Owner Address
        </figcaption>
</figure>

<p>Selanjutnya, karena <code>receive()</code> memerlukan require salah satunya <code>contributions[msg.sender] &gt; 0</code></p>
<p>kita perlu menjalankan <code>contribute()</code> terlebih dahulu untuk membuat kontribusi, berikut perintah untuk melakukan kontribusi dan nanti akan muncul popup metamask untuk konfirmasi transaksi</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span>await <span style="color:#66d9ef">contract</span>.contribute({ value<span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span> })
</span></span><span style="display:flex;"><span><span style="color:#75715e">// untuk value gunakan saja yang terendah, seperti diatas yaitu hanya 1 wei
</span></span></span></code></pre></div><figure class="align-center ">
    <img loading="lazy" src="/images/20230818/contribute.png#center"/> <figcaption>
            Running await contract.contribute() in console
        </figcaption>
</figure>

<p>Lalu kita cek dahulu apakah contribution kita sudah masuk atau belum dengan menjalankan perintah berikut</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span>await <span style="color:#66d9ef">contract</span>.getContribution().then(v <span style="color:#f92672">=&gt;</span> v.toString())
</span></span></code></pre></div><figure class="align-center ">
    <img loading="lazy" src="/images/20230818/getcontribution.png#center"/> <figcaption>
            Running await contract.getContribution() in console
        </figcaption>
</figure>

<p>Selanjutnya, untuk melakukan interaksi langsung ke <code>fallback</code> atau <code>receive</code> kita bisa menjalankan perintah berikut ini dan akan muncul popup metamask seperti biasa untuk konfirmasi</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span>await <span style="color:#66d9ef">contract</span>.sendTransaction({ <span style="color:#66d9ef">from</span><span style="color:#f92672">:</span> player, value<span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span> })
</span></span></code></pre></div><figure class="align-center ">
    <img loading="lazy" src="/images/20230818/sendtransac.png#center"/> <figcaption>
            Running await contract.sendTransaction() in console
        </figcaption>
</figure>

<p>Sekarang jika kita lihat owner contractnya sudah berubah sesuai dengan address yang kita miliiki</p>
<figure class="align-center ">
    <img loading="lazy" src="/images/20230818/owner-final.png#center"/> <figcaption>
            Owner contract address changed to our address
        </figcaption>
</figure>

<p>Langkah terakhir adalah melakukan withdraw dengan menjalankan perintah berikut ini dan kalian bisa lihat balance kalian bertambah</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span>await <span style="color:#66d9ef">contract</span>.withdraw()
</span></span></code></pre></div><figure class="align-center ">
    <img loading="lazy" src="/images/20230818/withdraw.png#center"/> <figcaption>
            Running await contract.withdraw() in console
        </figcaption>
</figure>

<p>Setelah selesai lakukan <code>Submit Instance</code> dann level 1 pun selesai</p>
<p>Oke level 1 sudah mulai menantang karena kita mencari code yang memungkinkan bisa kita exploit untuk mendapatkan owner dari contract itu sendiri. Baiklah kalau begitu mungkin segitu saja untuk level 1 ini, kita akan lanjutkan kembali level 2 dan seterusnya üî•</p>
<p>Seeya üëãüê¢</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://agilfchx.github.io/tags/ethernaut/">Ethernaut</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://agilfchx.github.io/">Ardias</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
